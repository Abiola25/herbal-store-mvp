<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Panel - MILNAPATH HERBAL PRODUCTS STORE</title>

<style>
body{
  font-family:Arial, sans-serif;
  background:#f0f7f1;
  padding:20px;
}
h1{
  text-align:center;
  color:#2e7d32;
  margin-bottom:30px;
}
section{
  margin-bottom:40px;
}
table{
  width:100%;
  border-collapse:collapse;
  background:#fff;
  border-radius:8px;
  overflow:hidden;
  box-shadow:0 2px 8px rgba(0,0,0,0.1);
}
th,td{
  padding:10px;
  border-bottom:1px solid #ddd;
  text-align:left;
}
th{
  background:#2e7d32;
  color:#fff;
}
tr:hover{
  background:#e0f2f1;
}
h2{
  color:#1b5e20;
  margin-bottom:10px;
}
.status{
  font-weight:bold;
}
.yes{color:green;}
.no{color:red;}
.top-actions{
  display:flex;
  justify-content:space-between;
  margin-bottom:20px;
}
button{
  padding:8px 12px;
  border:none;
  border-radius:5px;
  cursor:pointer;
}
.clear-btn{
  background:#b71c1c;
  color:white;
}
.back-btn{
  background:#1b5e20;
  color:white;
  text-decoration:none;
  padding:8px 12px;
  border-radius:5px;
}
small{
  color:#555;
}
</style>
</head>

<body>

<h1>Admin Panel – MILNAPATH HERBAL PRODUCTS STORE</h1>

<div class="top-actions">
<a href="../index.html" class="back-btn">⬅ Back to Store</a>
<button class="clear-btn" onclick="clearOrders()">Clear All Orders</button>
</div>

<!-- ORDERS -->
<section>
<h2>Customer Orders</h2>
<table id="orders-table">
<thead>
<tr>
<th>Date</th>
<th>Items Ordered</th>
<th>Total (₦)</th>
<th>Shipment</th>
<th>Proof of Payment</th>
</tr>
</thead>
<tbody></tbody>
</table>
<p><small>Orders are saved locally (offline mode).</small></p>
</section>

<!-- BOOKINGS -->
<section>
<h2>Booking / Test Requests</h2>
<table id="bookings-table">
<thead>
<tr>
<th>Date</th>
<th>Name</th>
<th>Email</th>
<th>Phone</th>
<th>Requested Test</th>
<th>Notes</th>
</tr>
</thead>
<tbody></tbody>
</table>
</section>

<script>
function loadOrders(){
  const orders = JSON.parse(localStorage.getItem("orders") || "[]");
  const products = JSON.parse(localStorage.getItem("products") || "[]");
  const tbody = document.querySelector("#orders-table tbody");
  tbody.innerHTML = "";

  if(orders.length === 0){
    tbody.innerHTML = "<tr><td colspan='5'>No orders yet.</td></tr>";
    return;
  }

  orders.forEach(order=>{
    let itemsText = "";
    let total = 0;

    order.items.forEach(it=>{
      const product = products.find(p=>p.id === it.id);
      if(product){
        const subtotal = product.price * it.qty;
        total += subtotal;
        itemsText += `${product.name} × ${it.qty} = ₦${subtotal}<br>`;
      }
    });

    const tr = document.createElement("tr");
    tr.innerHTML = `
<td>${order.date}</td>
<td>${itemsText}</td>
<td>₦${total}</td>
<td>${order.shipment}</td>
<td class="status ${order.proofUploaded?'yes':'no'}">
        ${order.proofUploaded ? "Uploaded" : "Not Uploaded"}
</td>
    `;
    tbody.appendChild(tr);
  });
}

function loadBookings(){
  const bookings = JSON.parse(localStorage.getItem("bookingRequests") || "[]");
  const tbody = document.querySelector("#bookings-table tbody");
  tbody.innerHTML = "";

  if(bookings.length === 0){
    tbody.innerHTML = "<tr><td colspan='6'>No booking requests yet.</td></tr>";
    return;
  }

  bookings.forEach(book=>{
    const tr = document.createElement("tr");
    tr.innerHTML = `
<td>${book.date}</td>
<td>${book.name}</td>
<td>${book.email}</td>
<td>${book.phone}</td>
<td>${book.test}</td>
<td>${book.notes || "-"}</td>
    `;
    tbody.appendChild(tr);
  });
}

function clearOrders(){
  if(confirm("Are you sure you want to clear ALL orders?")){
    localStorage.removeItem("orders");
    loadOrders();
  }
}

loadOrders();
loadBookings();
</script>

</body>
</html>
